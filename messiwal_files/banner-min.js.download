/**
 * Mobile Download Banner v1.3.1 by Tapcart
 * 
 * Provides html components and functionality for customers to download the Tapcart app from the App Store.
 */

!function(){"use strict";class t{static getCookieExpiresString(t){const e=new Date;return`expires=${new Date(e.getTime()+t).toGMTString()};`}static bake(e,n){document.cookie=`smartbanner_exited=1; ${e?t.getCookieExpiresString(e):""} path=${n}`}static unbake(){document.cookie="smartbanner_exited=; expires=Thu, 01 Jan 1970 00:00:01 GMT;"}static get baked(){return"1"===document.cookie.replace(/(?:(?:^|.*;\s*)smartbanner_exited\s*=\s*([^;]*).*$)|^.*$/,"$1")}}class e{parse(){var t={};const e=document.currentScript.src;var n=document.createElement("a");n.href=e;for(var a=n.search.substring(1).split("&"),i=0;i<a.length;i++){var r=a[i].split("=");r[1]&&(r[1]=(r[1]+"").replace(/\+/g," ")),t[r[0]]=decodeURIComponent(r[1])}return t}parseDefaults(){let t=document.getElementsByTagName("meta"),e={};return Array.apply(null,t).forEach((function(t){let n=null,a=t.getAttribute("name"),i=t.getAttribute("content");a&&i&&function(t){return-1!==t.indexOf("tapcart-banner:")&&t.split(":")[1].length>0}(a)&&i.length>0&&(n=a.split(":")[1],e[n]=i)})),e}}window.tapcartwebBanner=new class{constructor(){let t=new e;this.defaults=t.parseDefaults(),this.options=t.parse(),this.platform=class{static platform(){return/iPhone|iPad|iPod/i.test(window.navigator.userAgent)?"ios":/Android/i.test(window.navigator.userAgent)?"android":void 0}static bannerFrame(){return document.getElementById("tapcart-web-banner")}}.platform(),this.hideTtl=864e5,this.hidePath="/",this.minimumAppRating=4.3,this.appIcon=""}get html(){const{title:t,marketingCopy:e,ctaEvent:n}=this.options;return`\n<aside id="webbanner" class="webbanner" >\n\t<div class="webbanner-body">\n\t\t<a href="javascript:void(0);" class="webbanner-exit" aria-label="close" role="button"></a>\n\t\t<div class="webbanner-info">\n\t\t\t<figure class="webbanner-icon">\n\t\t\t\t\n\t\t\t</figure>\n\t\t\t<section class="webbanner-text">\n\t\t\t\t<div class="title">${t}</div>\n\t\t\t\t<div class="marketing">${e}</div>\n\t\t\t\t<div id="app-store-reviews">\n\t\t\t\t\t<ul id="review-stars"></ul>\n\t\t\t\t</div>\n\t\t\t</section>\n\t\t\t<section class="webbanner-button-wrap">\n\t\t\t\t<a\n\t\t\t\t\thref="${this.buttonUrl}"\n\t\t\t\t\ttarget="_blank"\n\t\t\t\t\tid="webbanner-button"\n\t\t\t\t\tclass="webbanner-button"\n\t\t\t\t\trel="noopener"\n\t\t\t\t\taria-label="download"\n\t\t\t\t\t><span class="webbanner-button-label">${n}</span></a\n\t\t\t\t>\n\t\t\t</section>\n\t\t</div>\n\t</div>\n</aside>\n          `}get buttonUrl(){const{playStoreId:t,appStoreId:e}=this.options;return"android"===this.platform?"market://details?id="+t:"ios"===this.platform?`https://apps.apple.com/app/id${e}?mt=8`:"#"}get placeholderImage(){return"android"===this.platform?"https://storage.googleapis.com/tapcart-150607.appspot.com/5759fff6e3445e719a113d28cbfc925b_playiconpng.png":"https://storage.googleapis.com/tapcart-150607.appspot.com/089cd83bb01a0c794c04cce844dd61e3_appstoreiconsvg.svg"}kFormatter(t){return t<30?"":Math.abs(t)>999?Math.sign(t)*(Math.abs(t)/1e3).toFixed(1)+"k":Math.sign(t)*Math.abs(t)}fetchRating(){const{appStoreId:t}=this.options,{locale:e}=this.defaults;return fetch(`https://cors-anywhere.herokuapp.com/https://itunes.apple.com/lookup?id=${t}${e?"&country="+e:""}`).then(t=>t.json()).then(t=>{let e=t.results[0];this.appIcon=this.defaults.appIcon||e.artworkUrl512||this.placeholderImage,this.generateStars(e)}).catch(t=>{this.appIcon=this.defaults.appIcon||this.placeholderImage,console.log("Could not generate banner ratings:",t)})}generateStars(t){if(0===t.averageUserRating||0===t.userRatingCount||t.averageUserRating<this.minimumAppRating)this.starList.style.display="none";else{let e="";const n=Math.ceil(t.averageUserRating);for(let t=1;t<6;t++)e+=t<=n?'<li class="banner-star banner-star-full"></li>':'<li class="banner-star banner-star-empty"></li>';this.starList.innerHTML=e,this.starList.insertAdjacentHTML("beforeend",this.kFormatter(t.userRatingCount))}}create(){const{iosLive:e,androidLive:n}=this.options;return!!this.platform&&(("ios"!==this.platform||"false"!==e)&&(("android"!==this.platform||"false"!==n)&&(!t.baked&&void this.render())))}render(){const{top:t}=this.defaults;let e=document.createElement("iframe");e.src="about:blank",e.style=`width: 100vw; min-width: 100%; left: 0; right: 0; ${t?"top":"bottom"}: 0; border: 0; position: fixed; display: none;`,e.scrolling="no",e.id="tapcart-web-banner",e.ariaLabel="Tapcart Download Banner",e.loading="eager",document.body.appendChild(e);let n=document.createElement("style");n.type="text/css",n.appendChild(document.createTextNode('\n@font-face { \n  font-family: system; \n  font-style: normal; \n  font-weight: 600; \n  src:  local(-apple-system), local(BlinkMacSystemFont), local(".SFNSText-Medium"), local(".HelveticaNeueDeskInterface-medium"), local(".LucidaGrandeUI"), local("Ubuntu Medium"), local("Segoe UI Medium"), local("Roboto-Medium"), local("DroidSans"), local("Tahoma"); \n } \n\n @font-face { \n  font-family: system-light; \n  font-style: normal; \n  font-weight: lighter; \n  src: local(-apple-system), local(BlinkMacSystemFont), local(".SFNSText-Light"), local(".HelveticaNeueDeskInterface-Light"), local(".LucidaGrandeUI"), local("Ubuntu Light"), local("Segoe UI Light"), local("Roboto-Light"), local("DroidSans"), local("Tahoma"); \n } \n\n.webbanner-body {\n  overflow: hidden;\n  height: 100%;\n}\n.webbanner#webbanner {\n  background-color: white;\n  border-radius: 10px;\n  box-shadow: rgba(0, 0, 0, 0.2) 0px 2px 16px 0px;\n  font-family: system;\n  font-weight: bold;\n  width: 90vw;\n  display: block;\n  visibility: visible;\n  opacity: 1;\n  border: none;\n  position: fixed;\n  bottom: 0px;\n  left: 0px;\n  right: 0px;\n  margin: auto auto 20px;\n  height: 84px;\n}\n.webbanner-exit {\n  position: absolute;\n  top: -10px;\n  right: -6px;\n  display: block;\n  margin: 0;\n  width: 28px;\n  height: 28px;\n  border: 0;\n  text-align: center;\n  border-radius: 14px;\n  background-color: rgb(215, 215, 215);\n}\n.webbanner-exit::before, .webbanner-exit::after {\n  position: absolute;\n  width: 2px;\n  height: 16px;\n  background: rgb(79, 79, 79);\n  content: " ";\n  top: 6px;\n}\n.webbanner-exit::before {\n  transform: rotate(45deg);\n}\n.webbanner-exit::after {\n  transform: rotate(-45deg);\n}\n.webbanner-icon {\n  border-radius: 15px;\n  background-size: 64px 64px;\n  margin: 0 15px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  \n}\n.webbanner-icon-image {\n  background-repeat: no-repeat;\n  background-size: cover;\n  width: 60px;\n  height: 60px;\n  box-shadow: 0 5px 12px 0 rgba(0, 0, 0, 0.2);\n  background-size: 100px 82px;\n  border-radius: 8.5px;\n  image-rendering: -moz-crisp-edges; /* Firefox */\nimage-rendering: -o-crisp-edges; /* Opera */\nimage-rendering: -webkit-optimize-contrast; /* Webkit (non-standard naming) */\nimage-rendering: crisp-edges;\n-ms-interpolation-mode: nearest-neighbor; /* IE (non-standard property) */\n}\n.webbanner-info {\n  height: 100%;\n  display: flex;\n  overflow-y: hidden;\n  justify-content: space-around;\n  align-items: center;\n  color: #000;\n}\n.title {\n  font-family: system;\n  font-size: 12px;\n  line-height: 16px;\n  letter-spacing: .04pt;\n}\n.marketing {\n  font-family: system-light;\n  font-weight: lighter;\n  font-size: 10px;\n  line-height: 15px;\n  letter-spacing: .04pt;\n  max-width: 130px;\n  word-break: break-word;\n}\n.webbanner-button#webbanner-button {\n  z-index: 1;\n  color: #fff !important;\n  background: #000;\n  padding: 10px 15px;\n  text-transform: uppercase;\n  text-decoration: none;\n  border-radius: 18px;\n  font-size: 12px;\n  line-height: 15px;\n  letter-spacing: 1px;\n  margin-right: 30%;\n  display: flex;\n  flex: 1;\n  justify-content: center;\n}\n.webbanner-button-label {\n  text-align: center;\n  word-break: normal;\n}\n.webbanner-text {\n  flex: 1;\n}\n.webbanner-button-wrap {\n  flex: .6;\n  display: flex;\n}\n#app-store-reviews {\n  font-family: system-light;\n  font-weight: light;\n  font-size: 10px;\n  color: rgb(187, 187, 187);\n  line-height: 15px;\n}\n#app-store-reviews ul {\n  list-style-type: none;\n  display: flex;\n  padding-inline-start: 0;\n  margin-block-start: 0;\n  margin-block-end: 0;\n}\n#app-store-reviews .banner-star {\n  display: inline-block;\n  width: 10px;\n  height: 12px;\n  margin-right: 2px;\n  -webkit-mask: url("data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' xmlns:xlink=\'http://www.w3.org/1999/xlink\' preserveAspectRatio=\'xMidYMid\' width=\'19\' height=\'20\' viewBox=\'0 0 19 20\'%3E %3Cpath d=\'M9.505,0.000 C9.505,0.000 12.450,6.269 12.450,6.269 C12.450,6.269 19.000,8.124 19.000,8.124 C19.000,8.124 14.250,12.519 14.250,12.519 C14.250,12.519 15.379,19.999 15.379,19.999 C15.379,19.999 9.500,16.855 9.500,16.855 C9.500,16.855 3.631,19.999 3.631,19.999 C3.631,19.999 4.768,12.519 4.768,12.519 C4.768,12.519 -0.000,8.124 -0.000,8.124 C-0.000,8.124 6.531,6.269 6.531,6.269 C6.531,6.269 9.505,0.000 9.505,0.000 \' id=\'path-1\' class=\'cls-2\' fill-rule=\'evenodd\'/%3E %3C/svg%3E") no-repeat center center/contain;\n  background-color: rgb(243, 209, 66);\n}\n\n#app-store-reviews .banner-star.banner-star-empty {\n  opacity: .5;\n  background-color: grey;\n}')),e.contentWindow.document.body.innerHTML=this.html,e.contentWindow.document.body.appendChild(n),this.closeIcon=e.contentWindow.document.querySelector(".webbanner-exit"),this.button=e.contentWindow.document.querySelector(".webbanner-button"),this.starList=e.contentWindow.document.querySelector("#review-stars"),this.imgWrap=e.contentWindow.document.querySelector(".webbanner-icon"),this.addEventListeners(),this.fetchRating().then(()=>{const t=new Image;t.src=this.appIcon,t.className="webbanner-icon-image",this.imgWrap.appendChild(t),t.onload=()=>{e.style.zIndex="2147483647",e.style.display="block"},t.onerror=()=>{e.style.zIndex="2147483647",e.style.display="block"}})}addEventListeners(){this.closeIcon.addEventListener("click",t=>function(t,e){e.exit(),t.preventDefault()}(t,this)),this.button.addEventListener("click",t=>{this.clickDownload()})}exit(){let e=document.getElementById("tapcart-web-banner");document.querySelector("body").removeChild(e);let n=new Event("tc-webbanner.exit");document.dispatchEvent(n),this.closeIcon=null,this.button=null,t.bake(this.defaults.hide?31536e4:this.hideTtl,this.hidePath)}clickDownload(){let t=new Event("tc-webbanner.download");document.dispatchEvent(t)}},"loading"!==window.readyState?setTimeout(()=>{window.tapcartwebBanner.create()},2e3):document.addEventListener("DOMContentLoaded",()=>setTimeout(()=>{window.tapcartwebBanner.create()},2e3))}();
