!function(n){"use strict";var t,e,o,r,i,c,s,C;!function(n){n.TRACKING_ACCEPTED="trackingConsentAccepted",n.TRACKING_DECLINED="trackingConsentDeclined",n.MARKETING_ACCEPTED="marketingConsentAccepted",n.STATISTICS_ACCEPTED="statisticsConsentAccepted",n.PREFERENCES_ACCEPTED="preferencesConsentAccepted",n.ATTRIBUTION_ACCEPTED="attributionConsentAccepted",n.MARKETING_DECLINED="marketingConsentDeclined",n.STATISTICS_DECLINED="statisticsConsentDeclined",n.PREFERENCES_DECLINED="preferencesConsentDeclined",n.ATTRIBUTION_DECLINED="attributionConsentDeclined",n.CONSENT_COLLECTED="visitorConsentCollected"}(t||(t={})),function(n){n.V2_0="2.0",n.V2_1="2.1"}(e||(e={})),function(n){n.ACCEPTED="yes",n.DECLINED="no",n.NO_INTERACTION="no_interaction",n.NO_VALUE=""}(o||(o={})),function(n){n.NO_VALUE="",n.ACCEPTED="1",n.DECLINED="0"}(r||(r={})),function(n){n.GDPR="GDPR",n.CCPA="CCPA",n.NO_VALUE=""}(i||(i={})),function(n){n.CCPA_BLOCK_ALL="CCPA_BLOCK_ALL",n.GDPR="GDPR",n.GDPR_BLOCK_ALL="GDPR_BLOCK_ALL",n.CCPA="CCPA"}(c||(c={})),function(n){n.MARKETING="m",n.STATISTICS="s",n.PREFERENCES="p",n.ATTRIBUTION="t"}(s||(s={})),function(n){n.MARKETING="marketing",n.STATISTICS="statistics",n.PREFERENCES="preferences",n.ATTRIBUTION="attribution"}(C||(C={}));const u=["lim","v","con","reg"];function E(n,t){const e=t.slice().sort();return n.length===t.length&&n.slice().sort().every((n,t)=>n===e[t])}function a(){const n=document.cookie?document.cookie.split("; "):[];let t=void 0;if(n.forEach(n=>{const[e,o]=n.split("=");if("_tracking_consent"===decodeURIComponent(e)){var r=JSON.parse(decodeURIComponent(o));t=r}}),void 0!==t&&!function(n){if(![e.V2_0,e.V2_1].includes(n.v))return!0;return!E(Object.keys(n),u)}(t))return t}function f(){try{let n=a();if(!n)return;return n.v===e.V2_0?function(n){const t=Object.assign(Object.assign({},n.con),{GDPR:I(n)?D(n.con.GDPR):void 0});void 0===t.GDPR&&delete t.GDPR;return{con:t,reg:n.reg,v:e.V2_1,lim:n.lim}}(n):n}catch(n){return}}function T(){const n=f();if(A(n))return D(r.NO_VALUE);const t=n.con;switch(typeof t.GDPR){case"undefined":return D(r.NO_VALUE);case"string":return D(t.GDPR);default:return t.GDPR}}function l(){const n=f();if(A(n))return r.NO_VALUE;const t=n.con.CCPA;return void 0===t?r.NO_VALUE:t}function A(n=null){return null===n&&(n=f()),void 0===n}function D(n){return{[s.MARKETING]:n,[s.STATISTICS]:n,[s.PREFERENCES]:n,[s.ATTRIBUTION]:n}}function I(n){const t=[c.GDPR,c.GDPR_BLOCK_ALL];return n.lim.some(n=>t.includes(n))&&i.GDPR in n.con}const N={"":[],GDPR:[c.GDPR,c.GDPR_BLOCK_ALL],CCPA:[c.CCPA_BLOCK_ALL,c.CCPA]};function P(n,t){document.dispatchEvent(new CustomEvent(n,{detail:t||{}}))}function _(n){!0===n.marketing?P(t.MARKETING_ACCEPTED):P(t.MARKETING_DECLINED),!0===n.statistics?P(t.STATISTICS_ACCEPTED):P(t.STATISTICS_DECLINED),!0===n.preferences?P(t.PREFERENCES_ACCEPTED):P(t.PREFERENCES_DECLINED),!0===n.attribution?P(t.ATTRIBUTION_ACCEPTED):P(t.ATTRIBUTION_DECLINED),P(t.CONSENT_COLLECTED,n)}function R(n,e,o){const r=new XMLHttpRequest,i=JSON.stringify(n);r.open("POST","/set_tracking_consent.json",!0),r.setRequestHeader("Content-Type","application/json"),r.onreadystatechange=function(){if(4!==r.readyState)return;const i=function(n){try{return JSON.parse(n)}catch(n){return{error:"Unknown error"}}}(r.responseText);var c;0===(c=r.status)||200>=c&&c<400?(!function(n,e){void 0!==n.consent?(!0===n.consent?P(t.TRACKING_ACCEPTED):P(t.TRACKING_DECLINED),e&&_({marketing:n.consent,preferences:n.consent,statistics:n.consent,attribution:n.consent})):void 0!==n.granular_consent&&_(n.granular_consent)}(n,o),e(null,i)):e(i)},r.send(i)}function d(n,t){if(A()){const n="Shop is not configured to block privacy regulation in online store settings.";return console.warn(n),t({error:n})}if(function(n){if(x()){if("boolean"!=typeof n&&"object"!=typeof n)throw TypeError("setTrackingConsent must be called with a boolean or object consent value");if("object"==typeof n){const t=Object.values(C);if(!E(t,Object.keys(n)))throw TypeError(`The submitted consent object should have exactly these keys: ${t.join(", ")}.`)}}else if("boolean"!=typeof n)throw TypeError("setTrackingConsent must be called with a boolean consent value")}(n),"function"!=typeof t)throw TypeError("setTrackingConsent must be called with a callback function");if("object"==typeof n){const e=h(n.statistics),o=G(n.statistics);return R(Object.assign(Object.assign({granular_consent:n},null!==e&&{referrer:e}),null!==o&&{landing_page:o}),t,x())}{const e=h(n),o=G(n);return R(Object.assign(Object.assign({consent:n},null!==e&&{referrer:e}),null!==o&&{landing_page:o}),t,x())}}function L(n,t){if("boolean"!=typeof n)throw TypeError("setCCPAConsent must be called with a boolean consent value");if("function"!=typeof t)throw TypeError("setCCPAConsent must be called with a callback function");return R({ccpa_consent:n},t,x())}function S(n){return A()?o.NO_VALUE:n===r.NO_VALUE?o.NO_INTERACTION:function(n){switch(n){case r.ACCEPTED:return o.ACCEPTED;case r.DECLINED:return o.DECLINED;default:return o.NO_VALUE}}(n)}function O(){if(A())return o.NO_VALUE;const n=T();return n[s.MARKETING]===r.ACCEPTED&&n[s.STATISTICS]===r.ACCEPTED?o.ACCEPTED:n[s.MARKETING]===r.DECLINED||n[s.STATISTICS]===r.DECLINED?o.DECLINED:o.NO_INTERACTION}function g(){const n=function(){const n=f();return A(n)?i.NO_VALUE:n.reg}();return n in i?n:i.NO_VALUE}function p(){return function(){const n=f();return A(n)?{limit:[]}:{limit:n.lim}}()}function h(n){return B(c.GDPR_BLOCK_ALL)&&n?b()?document.referrer:"":null}function G(n){return B(c.GDPR_BLOCK_ALL)&&n?b()?window.location.pathname+window.location.search:"/":null}function m(){return"string"==typeof navigator.globalPrivacyControl?"1"===navigator.globalPrivacyControl:Boolean(navigator.globalPrivacyControl)}function b(){if(""===document.referrer)return!0;const n=document.createElement("a");return n.href=document.referrer,window.location.hostname!=n.hostname}function y(){return B(c.GDPR)||B(c.GDPR_BLOCK_ALL)}function w(){const n=g();if(n===i.NO_VALUE)return!1;const t=p();return 0!==t.limit.length&&t.limit.some(t=>function(n,t){return N[n].includes(t)}(n,t))}function v(){return!!A()||function(){if(!y())return!0;const n=T();return n[s.MARKETING]===r.ACCEPTED&&n[s.STATISTICS]===r.ACCEPTED||n[s.MARKETING]!==r.DECLINED&&n[s.STATISTICS]!==r.DECLINED&&g()!==i.GDPR}()}function B(n){return p().limit.includes(n)}function k(){return!m()&&(!!A()||!1!==v()&&function(){if(B(c.CCPA_BLOCK_ALL)){return g()!==i.CCPA}if(B(c.CCPA)){return l()!==r.DECLINED}return!0}())}function K(){return g()===i.GDPR&&w()&&O()===o.NO_INTERACTION}function U(){return m()&&g()===i.CCPA?o.DECLINED:S(l())}function V(){return g()===i.CCPA&&p().limit.includes(c.CCPA)&&U()===o.NO_INTERACTION}function j(n){if(!y())return!0;const t=T();return t[n]===r.ACCEPTED||t[n]!==r.DECLINED&&g()!==i.GDPR}function M(){return j(s.STATISTICS)}function F(){return j(s.PREFERENCES)}function J(){return j(s.ATTRIBUTION)}function q(){return j(s.MARKETING)}function x(){return function(){const n=a();switch(null==n?void 0:n.v){case"2.0":return e.V2_0;case"2.1":return e.V2_1;default:return}}()===e.V2_1}function H(){g()===i.CCPA&&l()!=r.DECLINED&&B(c.CCPA)&&m()&&L(!1,()=>!1);const n={getTrackingConsent:O,setTrackingConsent:d,userCanBeTracked:v,getRegulation:g,isRegulationEnforced:w,getShopPrefs:p,shouldShowGDPRBanner:K,userDataCanBeSold:k,setCCPAConsent:L,getCCPAConsent:U,shouldShowCCPABanner:V};if(x()){const t={siteStatisticsCanBeCollected:M,preferencesCanBeStored:F,marketingCanBeAttributed:J,marketingProfileCanBeCreated:q};n.unstable=t}return n}window.Shopify=window.Shopify?window.Shopify:{},window.Shopify.customerPrivacy=window.Shopify.trackingConsent=H(),n.shopifyConsentAPI=H,Object.defineProperty(n,"__esModule",{value:!0})}({});
